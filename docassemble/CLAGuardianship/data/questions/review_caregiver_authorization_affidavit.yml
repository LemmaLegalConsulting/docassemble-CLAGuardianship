---
include:
  - caregiver_authorization_affidavit.yml
---
id: review caregiover authorization affidavit
event: review_full
question: |
  Review your answers
review:
  - note: |
      <h2 class='h5'>Your Information</h2>
    show if: users[0].name.first
  - Edit: users[0].name.first
    button: |-
      % for item in users:

        **${ item }**

        ${ item.address }

      % endfor
  - Edit: 
      - relationship_to_child
      - recompute:
        - reset_other_parent_agreement
    button: |-
      **I am the minor's:**
      % if relationship_to_child == "parent":

      Parent

      **Does the minor have another parent whom you know and are able to contact?**
      % if other_parent:

      Yes
      
      **Does the other parent also agree to this persmission?**
      % if other_parent_agrees:

      Yes
      % else:

      No
      % endif
      % else:

      No
      % endif
      % elif relationship_to_child == "legal guardian":

      Guardian
      % elif relationship_to_child == "legal custodian":

      Custodian
      % endif
  - note: |
      <hr>
      <h2 class='h5'>The Other Parent</h2>
    show if: len(non_appointing_parent.complete_elements()) > 0
  - Edit: non_appointing_parent[0].name.first
    button: |-
      % for item in non_appointing_parent:

        **${ item }**

        ${ item.address }

        ${ phone_number_formatted(item.phone_number) }
      % endfor
  - note: |
      <hr>
      % if len(children.complete_elements()) < 2:
      <h2 class='h5'>The Minor</h2>
      % else:
      <h2 class='h5'>The Minors</h2>
      % endif
    show if: children[0].name.first
  - Edit: children[0].name.first
    button: |-
      % for item in children:

        **${ item.name }**
        
        DOB: ${ item.birthdate }

      % endfor
  - note: |
      <hr>
      <h2 class='h5'>Person Authorized to Care for Minor</h2>
    show if: authorized_persons[0].name.first
  - Edit: 
      - authorized_persons.revisit
    button: |-
      % for item in authorized_persons:

        **${ item }**
      
        % if item.phone_number:
        ${ phone_number_formatted(item.phone_number) }
        % endif

        **Relationship to minor:**
        % if caregiver_relationship_to_child == "aunt":

        Minor's aunt
        % elif caregiver_relationship_to_child == "uncle":

        Minor's uncle

        % elif caregiver_relationship_to_child == "parent's sibling":

        Minor's parent's sibling

        % elif caregiver_relationship_to_child == "grandparent":

        Minor's grandparent

        % elif caregiver_relationship_to_child == "sibling":

        Minor's sibling

        % elif caregiver_relationship_to_child == "cousin":

        Minor's cousin

        % elif caregiver_relationship_to_child == "parent's friend":

        Minor's parent's friend

        % elif caregiver_relationship_to_child == "other":

        ${ caregiver_other_relationship_to_child }
        % endif
      % endfor
  - Edit: permission_kind
    button: |-
      **I want to give ${ authorized_persons[0] } permission to:**
      % if permission_kind == "caregiver authorization affidavit":

      Make decisions about medical treatment and education, for up to 2 years.
      % elif permission_kind == "temporary agent affidavit":

      Make most parental decisions, other than adoption, for up to 60 days.
      % endif
    show if: len(authorized_persons.complete_elements()) > 0 and defined('permission_kind')
  - Edit: expiration_of_authorization
    button: |-
      **My permission ends on:**

      ${ expiration_of_authorization }
      % if excluded_powers != "":

      **${ authorized_persons[0] } is not permitted to do the following:**

      ${ excluded_powers }
      % endif
---
continue button field: children.revisit
question: |
  Edit the Minor's Information
subquestion: |
  ${ children.table }

  ${ children.add_action() }
---
table: children.table
rows: children
columns:
  - Name: |
      row_item.name.full() if defined("row_item.name.first") else ""
  - Birthdate: |
      row_item.birthdate if defined("row_item.birthdate") else ""
  - Address: |
      row_item.address.block() if defined("row_item.address.county") else ""
edit:
  - name.first
  - birthdate
  - address.county
confirm: True
---
continue button field: users.revisit
question: |
  Edit Your Information
subquestion: |
  ${ users.table }
---
table: users.table
rows: users
columns:
  - Name: |
      row_item.name.full() if defined("row_item.name.last") else ""
  - Address: |
      row_item.address.block() if defined("row_item.address.unit") else ""
  - Phone number: |
      row_item.phone_number if defined("row_item.phone_number") else ""
edit:
  - name.first
  - address.unit
  - phone_number
confirm: True
---
continue button field: authorized_persons.revisit
question: |
  Edit Person Authorized to Care for Minor
subquestion: |
  ${ authorized_persons.table }
---
table: authorized_persons.table
rows: authorized_persons
columns:
  - Name: |
      row_item.name.full() if defined("row_item.name.last") else ""
edit:
  - name.first
delete buttons: False
---